---
description: 创建与项目章程原则一致的详细功能规格说明。
handoffs:
  - label: 创建实施计划
    agent: speckit.plan
    prompt: 为此规格说明构建实施计划
  - label: 生成任务
    agent: speckit.tasks
    prompt: 将此规格说明分解为可执行任务
---

## 用户输入

```text
{user_input}
```

您**必须**在继续之前考虑用户输入（如果非空）。

## 大纲

您正在使用 `.specify/templates/spec-template.md` 的模板创建功能规格说明。规格说明必须与项目章程一致。

遵循此执行流程：

1. **加载章程**，从 `.specify/memory/constitution.md`
   - 提取适用于此功能的关键原则
   - 记录版本号供参考

2. **加载规格说明模板**，从 `.specify/templates/spec-template.md`
   - 识别所有占位符标记 `[PLACEHOLDER]`

3. **收集需求：**
   - 解析用户输入以获取功能描述
   - 识别用户故事和验收标准
   - 确定范围（在范围内/不在范围内）
   - 如果不清楚，提出澄清问题

4. **章程一致性检查：**
   - 对于每个原则，确定适用性
   - 记录规格说明如何遵守每个相关原则
   - 及早标记任何潜在冲突

5. **起草规格说明：**
   - 用具体内容替换所有占位符
   - **功能需求：** 每个都有优先级、描述、验收标准、章程检查
   - **非功能需求：** 根据章程的性能、安全、类型安全
   - **API 契约：** Pydantic 模型、camelCase JSON、错误响应
   - **数据模型：** SQLite 模式（如适用）
   - **测试需求：** 单元、集成、手动测试（最低 80% 覆盖率）

6. **验证：**
   - 所有功能需求都有可衡量的验收标准
   - API 契约显示 snake_case（Python）和 camelCase（JSON）格式
   - 错误处理涵盖验证失败
   - 无占位符标记保留
   - 每个需求的章程一致性明确

7. **写入规格说明** 到适当位置：
   - 建议路径：`.specify/specs/[功能名称]-spec.md`
   - 或用户指定的路径

8. **输出摘要：**
   - 规格说明位置
   - 应用的章程原则
   - 关键需求（前 3-5 个）
   - 建议的下一步（创建计划或任务）
   - 提交消息建议

## 格式要求

- 对结构化数据使用 Markdown 表格
- 对模式使用代码块（SQL、Python、TypeScript、JSON）
- 对验收标准和测试列表使用复选框
- 保持部分简洁但完整

如果用户输入模糊，根据以下推断合理默认值：
- 项目上下文（这是一个数据库查询工具）
- 章程原则（例如，需要 Pydantic 模型）
- 代码库中的现有模式

在"待解决问题"部分标记模糊之处以供用户澄清。
