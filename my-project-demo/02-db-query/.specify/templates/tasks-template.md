# 任务列表：[功能名称]

**相关规格说明：** [链接到规格说明文件]  
**相关计划：** [链接到计划文件]  
**最后更新：** [YYYY-MM-DD]

---

## 任务分类

任务按章程原则组织，以确保系统化合规。

---

## 阶段 1：[阶段名称]

### 原则 1：Ergonomic Python 与严格的 TypeScript

- [ ] **TASK-001：** 在后端配置 `mypy` 进行严格类型检查
  - **负责人：** [姓名或待定]
  - **工作量：** 1 小时
  - **状态：** 未开始
  - **依赖：** 无

- [ ] **TASK-002：** 在 `tsconfig.json` 中启用 TypeScript 严格模式
  - **负责人：** [姓名或待定]
  - **工作量：** 30 分钟
  - **状态：** 未开始
  - **依赖：** 无

---

### 原则 2：全面的类型标注

- [ ] **TASK-003：** 在 `[模块名].py` 中为所有后端函数添加类型提示
  - **负责人：** [姓名或待定]
  - **工作量：** 3 小时
  - **状态：** 未开始
  - **依赖：** TASK-001

- [ ] **TASK-004：** 在 `types.ts` 中为所有 API 契约定义 TypeScript 接口
  - **负责人：** [姓名或待定]
  - **工作量：** 2 小时
  - **状态：** 未开始
  - **依赖：** TASK-002

---

### 原则 3：使用 Pydantic 进行数据建模

- [ ] **TASK-005：** 为 [功能] 创建 Pydantic 请求/响应模式模型
  - **负责人：** [姓名或待定]
  - **工作量：** 2 小时
  - **状态：** 未开始
  - **依赖：** TASK-003

- [ ] **TASK-006：** 为 [特定字段] 约束添加 Pydantic 验证器
  - **负责人：** [姓名或待定]
  - **工作量：** 1 小时
  - **状态：** 未开始
  - **依赖：** TASK-005

---

### 原则 4：camelCase JSON 约定

- [ ] **TASK-007：** 为所有模型配置 Pydantic `alias_generator=to_camel`
  - **负责人：** [姓名或待定]
  - **工作量：** 30 分钟
  - **状态：** 未开始
  - **依赖：** TASK-005

- [ ] **TASK-008：** 在集成测试中验证 API 响应使用 camelCase
  - **负责人：** [姓名或待定]
  - **工作量：** 1 小时
  - **状态：** 未开始
  - **依赖：** TASK-007

---

### 原则 5：无身份验证

- [ ] **TASK-009：** 在 README 中记录"无身份验证"设计决策
  - **负责人：** [姓名或待定]
  - **工作量：** 30 分钟
  - **状态：** 未开始
  - **依赖：** 无

- [ ] **TASK-010：** 添加关于不受信任网络风险的部署警告
  - **负责人：** [姓名或待定]
  - **工作量：** 15 分钟
  - **状态：** 未开始
  - **依赖：** TASK-009

---

### 原则 6：宽松的 CORS 策略

- [ ] **TASK-011：** 添加 FastAPI `CORSMiddleware`，配置 `allow_origins=["*"]`
  - **负责人：** [姓名或待定]
  - **工作量：** 30 分钟
  - **状态：** 未开始
  - **依赖：** 无

- [ ] **TASK-012：** 在浏览器开发工具中测试 CORS 头
  - **负责人：** [姓名或待定]
  - **工作量：** 15 分钟
  - **状态：** 未开始
  - **依赖：** TASK-011

---

### 原则 7：SQL 安全与查询限制

- [ ] **TASK-013：** 使用 `sqlglot.parse_one()` 实现 SQL 解析
  - **负责人：** [姓名或待定]
  - **工作量：** 2 小时
  - **状态：** 未开始
  - **依赖：** 无

- [ ] **TASK-014：** 添加仅 SELECT 验证（拒绝 INSERT/UPDATE/DELETE/DROP）
  - **负责人：** [姓名或待定]
  - **工作量：** 1 小时
  - **状态：** 未开始
  - **依赖：** TASK-013

- [ ] **TASK-015：** 如果 SELECT 查询中缺少，注入 `LIMIT 1000`
  - **负责人：** [姓名或待定]
  - **工作量：** 1 小时
  - **状态：** 未开始
  - **依赖：** TASK-014

- [ ] **TASK-016：** 为 SQL 验证边缘情况编写单元测试
  - **负责人：** [姓名或待定]
  - **工作量：** 2 小时
  - **状态：** 未开始
  - **依赖：** TASK-015

---

### 原则 8：在 SQLite 中缓存元数据

- [ ] **TASK-017：** 为 `connections`、`tables`、`columns` 创建 SQLite 模式
  - **负责人：** [姓名或待定]
  - **工作量：** 2 小时
  - **状态：** 未开始
  - **依赖：** 无

- [ ] **TASK-018：** 实现从 PostgreSQL 系统目录提取元数据
  - **负责人：** [姓名或待定]
  - **工作量：** 4 小时
  - **状态：** 未开始
  - **依赖：** TASK-017

- [ ] **TASK-019：** 构建 API 端点 `POST /connections/{id}/refresh`
  - **负责人：** [姓名或待定]
  - **工作量：** 3 小时
  - **状态：** 未开始
  - **依赖：** TASK-018

- [ ] **TASK-020：** 将缓存的元数据序列化为 JSON 用于 LLM 上下文
  - **负责人：** [姓名或待定]
  - **工作量：** 2 小时
  - **状态：** 未开始
  - **依赖：** TASK-019

---

### 原则 9：仅结构化数据响应

- [ ] **TASK-021：** 确保所有 API 路由返回 Pydantic 模型（无纯字符串）
  - **负责人：** [姓名或待定]
  - **工作量：** 1 小时
  - **状态：** 未开始
  - **依赖：** TASK-005

- [ ] **TASK-022：** 定义错误响应模式（JSON:API 或 RFC 7807）
  - **负责人：** [姓名或待定]
  - **工作量：** 1 小时
  - **状态：** 未开始
  - **依赖：** 无

- [ ] **TASK-023：** 为结构化错误响应添加 FastAPI 异常处理器
  - **负责人：** [姓名或待定]
  - **工作量：** 2 小时
  - **状态：** 未开始
  - **依赖：** TASK-022

---

## 阶段 2：[阶段名称]

### 前端实施

- [ ] **TASK-024：** 使用 Refine 5 搭建 React 组件结构
  - **负责人：** [姓名或待定]
  - **工作量：** 3 小时
  - **状态：** 未开始
  - **依赖：** TASK-004

- [ ] **TASK-025：** 集成 Monaco Editor 用于 SQL 输入
  - **负责人：** [姓名或待定]
  - **工作量：** 4 小时
  - **状态：** 未开始
  - **依赖：** TASK-024

- [ ] **TASK-026：** 使用 Ant Design 构建结果表格显示
  - **负责人：** [姓名或待定]
  - **工作量：** 3 小时
  - **状态：** 未开始
  - **依赖：** TASK-025

- [ ] **TASK-027：** 实现验证失败的错误消息 UI
  - **负责人：** [姓名或待定]
  - **工作量：** 2 小时
  - **状态：** 未开始
  - **依赖：** TASK-026

---

### 集成与测试

- [ ] **TASK-028：** 为完整查询流程编写集成测试（前端 → 后端 → DB）
  - **负责人：** [姓名或待定]
  - **工作量：** 4 小时
  - **状态：** 未开始
  - **依赖：** TASK-027

- [ ] **TASK-029：** 在 CI 管道中运行 E2E 测试
  - **负责人：** [姓名或待定]
  - **工作量：** 2 小时
  - **状态：** 未开始
  - **依赖：** TASK-028

- [ ] **TASK-030：** 执行手动 QA 清单（章程合规性）
  - **负责人：** [姓名或待定]
  - **工作量：** 2 小时
  - **状态：** 未开始
  - **依赖：** TASK-029

---

## 可观测性与文档

- [ ] **TASK-031：** 向后端添加结构化日志（JSON 日志）
  - **负责人：** [姓名或待定]
  - **工作量：** 2 小时
  - **状态：** 未开始
  - **依赖：** 无

- [ ] **TASK-032：** 在 README 中记录 API 端点及示例
  - **负责人：** [姓名或待定]
  - **工作量：** 2 小时
  - **状态：** 未开始
  - **依赖：** TASK-021

- [ ] **TASK-033：** 创建本地开发快速入门指南
  - **负责人：** [姓名或待定]
  - **工作量：** 1 小时
  - **状态：** 未开始
  - **依赖：** 无

---

## 任务摘要

| 状态 | 数量 |
|-----|------|
| 未开始 | [X] |
| 进行中 | [X] |
| 已阻止 | [X] |
| 已完成 | [X] |
| **总计** | **33** |

---

## 备注

- 所有任务与章程原则一致，确保系统化合规
- 任务必须通过类型检查（mypy、TypeScript）才能标记为完成
- 集成测试必须验证 camelCase API 响应
- SQL 验证任务是关键路径——尽早优先处理
